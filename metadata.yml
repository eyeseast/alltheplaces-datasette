databases:
  alltheplaces:
    tables:
      KNN:
        hidden: true

      data_licenses:
        hidden: true

    queries:
      count_by_spider:
        sql: |
          select
            json_extract(properties, "$.@spider") as spider,
            count(*) as count
          from
            places
          group by
            spider
          order by
            spider

      dunkin_in_boston:
        title: Dunkin in Boston
        sql: |
          select
            id,
            properties,
            json_extract(properties, '$.addr:full') as address,
            json_extract(properties, '$.website') as website,
            geometry,
            'small' as [marker-size],
            'cafe' as [marker-symbol]
          from
            places
          where
            json_extract(properties, '$.@spider') = 'dunkindonuts'
            and json_extract(properties, '$.addr:state') = 'MA'
            and json_extract(properties, '$.addr:city') LIKE '%Boston%'
